/*! tweetlight 4.0.0 | (c) 2015 Pedro RogÃ©rio | MIT License */
!function(a,b){"function"==typeof define&&define.amd?define("tweetlight",b):"object"==typeof exports?module.exports=b():a.Tweetlight=b()}(this,function(){"use strict";var a=function(b){return this&&this instanceof a?("string"==typeof b&&(b={key:b}),this.username=b.username,this.hashtag=b.hashtag,this.container=b.container,this.counter=b.counter,this.endpoint="../request.php",this.onComplete=b.onComplete||function(){},void this.fetch()):new a(b)};return a.init=function(b){return new a(b)},a.prototype={fetch:function(){var a=this.hashtag?"hashtag="+encodeURIComponent(this.hashtag):"username="+this.username,b=this.counter?"&count="+this.counter:"",c=this.endpoint+"?"+a+b;this.getJSON(c,this.loadTweets)},getJSON:function(a,b){var c=new XMLHttpRequest,d=this;c.open("GET",a,!0),c.onreadystatechange=function(){if(4===this.readyState){if(!(this.status>=200&&this.status<400))throw new Error(this.status+" - "+this.statusText);var a=JSON.parse(this.responseText);b.call(d,a)}},c.send(),c=null},loadTweets:function(a){var b=a.httpstatus;200===b?(a.statuses&&(a=a.statuses),this.displayTweets(a),this.onComplete()):this.displayError(a)},displayTweets:function(a){var b,c=document.querySelector(this.container),d="";for(b in a)a.hasOwnProperty(b)&&a[b].text&&(d+='<li><span class="tweet">'+this.twitterLinks(a[b].text)+'</span><span class="created">'+this.prettyDate(a[b].created_at)+"</span></li>");c.innerHTML=d},displayError:function(a){var b=document.querySelector(this.container);b.innerHTML='<li class="error">'+a.errors.message+"</li>"},prettyDate:function(a){var b=new Date,c=new Date(a);(-1!==navigator.userAgent.indexOf("MSIE")||navigator.appVersion.indexOf("Trident/")>0)&&(c=Date.parse(a.replace(/( \+)/," UTC$1")));var d=b-c,e=1e3,f=60*e,g=60*f,h=24*g;return isNaN(d)||0>d?"":2*e>d?"just now":f>d?Math.floor(d/e)+" seconds ago":2*f>d?"1 minute ago":g>d?Math.floor(d/f)+" minutes ago":2*g>d?"1 hour ago":h>d?Math.floor(d/g)+" hours ago":d>h&&2*h>d?"yesterday":365*h>d?Math.floor(d/h)+" days ago":"over a year ago"},twitterLinks:function(a){return a=a.replace(/(https?:\/\/)([\w\-:;?&=+.%#\/]+)/gi,'<a href="$1$2">$2</a>').replace(/(^|\W)@(\w+)/g,'$1<a href="https://twitter.com/$2">@$2</a>').replace(/(^|\W)#(\w+)/g,'$1<a href="https://twitter.com/search?q=%23$2">#$2</a>')}},a});