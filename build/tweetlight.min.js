/*! tweetlight - Display your latest tweets with pure JavaScript and PHP OAuth Library v4.5.0 | (c) 2017 Pedro RogÃ©rio | MIT License */
!function(t,e){"use strict";"function"==typeof define&&define.amd?define("tweetlight",e):"object"==typeof exports?module.exports=e():t.Tweetlight=e()}(this,function(){"use strict";Function.prototype.hasOwnProperty("bind")||(Function.prototype.bind=function(){var t=this,e=arguments[0],s=Array.prototype.slice.call(arguments,1);return function(){return t.apply(e,s.concat(Array.prototype.slice.call(arguments)))}});var t=function(e){if(!(this&&this instanceof t))return new t(e);e?(this.endpoint="../request.php",this.username=e.username,this.hashtag=e.hashtag,this.container=e.container,this.counter=e.counter,this.showImageProfile=e.showImageProfile||!1,this.onComplete=e.onComplete||void 0,this.fetch()):console.log("%c Don't initialize the plugin without setting a username or without setting an html element to attach tweets","background: red; color: white")};return t.prototype={inject:function(t,e){t.insertAdjacentHTML("beforeend",e)},fetch:function(){var t=this.hashtag?"hashtag="+encodeURIComponent(this.hashtag):"username="+this.username,e=this.counter?"&count="+this.counter:"",s=this.endpoint+"?"+t+e;this.getJSON(s).then(this.loadTweets.bind(this),this.failure.bind(this))},getJSON:function(t){return new Promise(function(e,s){function n(t){s("Network Error: "+t.target.status)}var i=new XMLHttpRequest;i.open("GET",t,!0),i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.setRequestHeader("Content-type","application/json"),i.onreadystatechange=function(){if(4===this.readyState)if(this.status>=200&&this.status<300||304===this.status){var t=JSON.parse(this.responseText);e(t)}else{var n=this.statusText;s("Http/App Error: "+n)}},i.onerror=n,i.onabort=n,i.send(),i=null})},loadTweets:function(t){200===t.httpstatus?(t.statuses&&(t=t.statuses),this.displayTweets(t),"function"==typeof this.onComplete&&this.onComplete.call()):this.displayError(t)},displayTweets:function(t){var e,s,n=document.querySelector(this.container);for(s in t)t.hasOwnProperty(s)&&t[s].text&&(e="<li>"+(this.showImageProfile?'<img class="image-profile" src="'+t[s].user.profile_image_url_https+'" alt="'+t[s].user.name+'">':"")+'<span class="tweet">'+this.twitterLinks(t[s].text)+'</span><span class="created">'+this.prettyDate(t[s].created_at)+"</span></li>",this.inject(n,e))},displayError:function(t){var e=document.querySelector(this.container);this.inject(e,'<li class="error">'+t.errors[0].message+"</li>")},failure:function(t){console.log(t)},prettyDate:function(t){var e,s,n=new Date,i=new Date(t);return(-1!==navigator.userAgent.indexOf("MSIE")||navigator.appVersion.indexOf("Trident/")>0)&&(i=Date.parse(t.replace(/( \+)/," UTC$1"))),e=n-i,1e3,6e4,36e5,s=864e5,7*s,isNaN(e)||e<0?"":e<2e3?"just now":e<6e4?Math.floor(e/1e3)+" seconds ago":e<12e4?"1 minute ago":e<36e5?Math.floor(e/6e4)+" minutes ago":e<72e5?"1 hour ago":e<s?Math.floor(e/36e5)+" hours ago":e>s&&e<2*s?"yesterday":e<31536e6?Math.floor(e/s)+" days ago":"over a year ago"},twitterLinks:function(t){return t=t.replace(/(https?:\/\/)([\w\-:;?&=+.%#\/]+)/gi,'<a href="$1$2">$2</a>').replace(/(^|\W)@(\w+)/g,'$1<a href="https://twitter.com/$2">@$2</a>').replace(/(^|\W)#(\w+)/g,'$1<a href="https://twitter.com/search?q=%23$2">#$2</a>')}},t});