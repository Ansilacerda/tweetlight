/*! tweetlight - Display your latest tweets with pure JavaScript and PHP OAuth Library v4.3.0 | (c) 2016 Pedro RogÃ©rio | MIT License */
!function(a,b){"use strict";"function"==typeof define&&define.amd?define("tweetlight",b):"object"==typeof exports?module.exports=b():a.Tweetlight=b()}(this,function(){"use strict";Function.prototype.hasOwnProperty("bind")||(Function.prototype.bind=function(){var a=this,b=arguments[0],c=Array.prototype.slice.call(arguments,1);return function(){return a.apply(b,c.concat(Array.prototype.slice.call(arguments)))}});var a=function(b){return this&&this instanceof a?b?(this.endpoint="../request.php",this.username=b.username,this.hashtag=b.hashtag,this.container=b.container,this.counter=b.counter,this.showImageProfile=b.showImageProfile||!1,this.onComplete=b.onComplete||void 0,void this.fetch()):void console.log("%c Don't initialize the plugin without setting a username or without setting an html element to attach tweets","background: red; color: white"):new a(b)};return a.prototype={inject:function(a,b){a.insertAdjacentHTML("beforeend",b)},fetch:function(){var a=this.hashtag?"hashtag="+encodeURIComponent(this.hashtag):"username="+this.username,b=this.counter?"&count="+this.counter:"",c=this.endpoint+"?"+a+b;this.getJSON(c,this.loadTweets.bind(this),this.failure.bind(this))},getJSON:function(a,b,c){var d=new XMLHttpRequest;d.open("GET",a,!0),d.setRequestHeader("X-Requested-With","XMLHttpRequest"),d.setRequestHeader("Content-type","application/json"),d.onreadystatechange=function(){if(4===this.readyState)if(this.status>=200&&this.status<300||304===this.status){var a=JSON.parse(this.responseText);b.call(this,a)}else c.call(this,this.status+" - "+this.statusText)},d.send(),d=null},loadTweets:function(a){var b=a.httpstatus;200===b?(a.statuses&&(a=a.statuses),this.displayTweets(a),"function"==typeof this.onComplete&&this.onComplete.call()):this.displayError(a)},displayTweets:function(a){var b,c,d,e=document.querySelector(this.container);for(d in a)a.hasOwnProperty(d)&&a[d].text&&(c=this.showImageProfile?'<img class="image-profile" src="'+a[d].user.profile_image_url_https+'" alt="'+a[d].user.name+'">':"",b="<li>"+c+'<span class="tweet">'+this.twitterLinks(a[d].text)+'</span><span class="created">'+this.prettyDate(a[d].created_at)+"</span></li>",this.inject(e,b))},displayError:function(a){var b=document.querySelector(this.container);this.inject(b,'<li class="error">'+a.errors[0].message+"</li>")},failure:function(a){console.log(a)},prettyDate:function(a){var b,c,d,e,f,g,h=new Date,i=new Date(a);return(-1!==navigator.userAgent.indexOf("MSIE")||navigator.appVersion.indexOf("Trident/")>0)&&(i=Date.parse(a.replace(/( \+)/," UTC$1"))),b=h-i,c=1e3,d=60*c,e=60*d,f=24*e,g=7*f,isNaN(b)||0>b?"":2*c>b?"just now":d>b?Math.floor(b/c)+" seconds ago":2*d>b?"1 minute ago":e>b?Math.floor(b/d)+" minutes ago":2*e>b?"1 hour ago":f>b?Math.floor(b/e)+" hours ago":b>f&&2*f>b?"yesterday":365*f>b?Math.floor(b/f)+" days ago":"over a year ago"},twitterLinks:function(a){return a=a.replace(/(https?:\/\/)([\w\-:;?&=+.%#\/]+)/gi,'<a href="$1$2">$2</a>').replace(/(^|\W)@(\w+)/g,'$1<a href="https://twitter.com/$2">@$2</a>').replace(/(^|\W)#(\w+)/g,'$1<a href="https://twitter.com/search?q=%23$2">#$2</a>')}},a});